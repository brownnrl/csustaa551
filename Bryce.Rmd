---
title: "Bryce"
author: "Bryce Smith"
date: "2/24/2021"
output: word_document
---

Notes:
- Categorical Variables: waterfront (0-1), view (0-1), condition (1-5), grade (5-12)
- Quantitative Variables: bedrooms, bathrooms, sqft. sqftlot, floors, sqftabove, sqftbasement, *yrbuilt*, *yrrenovated*
- Exclude: ID
- sqft_living highest correlation with price




*{variable}* = unsure
```{r}
df_mod <- read.csv('Seattle.csv')
attach(df_mod)
summary(df)
head(df,4)
```
#Changing the date value
```{r}
library(lubridate)
df$date <- ymd(substr(date,1,nchar(date) - 7))
head(df,4)
```
#Scatterplots
```{r}
par(mfrow = c(1,2))
plot(df$date, df$price, xlab = "Date", ylab = "Price")
plot(df$bedrooms, df$price, xlab = "bedrooms", ylab = "price")
```
```{r}
par(mfrow = c(1,2))
plot(df$bathrooms, df$price, xlab = "bathrooms", ylab = "price")
plot(df$sqft_living, df$price, xlab = "sqft", ylab = "price")
```
```{r}
par(mfrow = c(1,2))
plot(df$sqft_lot, df$price, xlab = "Lot Square Footage", ylab = "Price")
plot(df$floors, df$price, xlab = "# of Floors", ylab = "Price")
```
```{r}
par(mfrow = c(1,2))
plot(df$condition, df$price, xlab = "Condition", ylab = "Price")
plot(df$grade, df$price, xlab = "Grade", ylab = "Price")
```

```{r}
par(mfrow = c(1,2))
plot(df$sqft_above, df$price, xlab = "sqft_above", ylab = "Price")
plot(df$sqft_basement, df$price, xlab = "sqft_basement", ylab = "Price")
```

```{r}
par(mfrow = c(1,2))
plot(df$yr_built, df$price, xlab = "Year Built", ylab = "Price")
plot(df$yr_renovated, df$price, xlab = "Year Renovated", ylab = "Price")
```
#Correlations
```{r}
cor(df[,c(3,4,5,6,7,8,13)])
```

```{r}
df$bedrooms <- as.factor(df$bedrooms)

ggplot(df, aes(x=bedrooms, y=price, fill=bedrooms)) +
  theme_solarized(light = TRUE) +
  scale_colour_solarized("red") +
  geom_violin(aes(color=bedrooms)) +
  geom_boxplot(width=0.1) +
  ggtitle("Price by Number of Bedrooms") +
  xlab("Number of Bedrooms") +
  ylab("Price") +
  theme(legend.position="none", plot.title = element_text(hjust = 0.5))

```
```{r}
df$floors <- as.factor(df$floors)

ggplot(df, aes(x=floors, y=price, fill=floors)) +
  theme_solarized(light = TRUE) +
  scale_colour_solarized("red") +
  geom_violin(aes(color=floors)) +
  geom_boxplot(width=0.1) +
  ggtitle("Price by Number of Floors") +
  xlab("Number of Floors") +
  ylab("Price") +
  theme(legend.position="none", plot.title = element_text(hjust = 0.5))

```

#Binning bathrooms
```{r}
library(tidyverse)
library(dplyr)
library(scales)
tags <- c("[0-1]", "[1-2]","[2-3]", "[3-4]", "[4-6]")
v <- df %>% select(price, bathrooms)
vgroup <- as_tibble(v) %>% mutate(tag = case_when(
  bathrooms == 0.25|bathrooms == 0.5|bathrooms == 0.75|bathrooms == 1.00 ~ tags[1],
  bathrooms == 1.25|bathrooms == 1.5|bathrooms == 1.75|bathrooms == 2.00 ~ tags[2],
  bathrooms == 2.25|bathrooms == 2.5|bathrooms == 2.75|bathrooms == 3.00 ~ tags[3],
  bathrooms == 3.25|bathrooms == 3.5|bathrooms == 3.75|bathrooms == 4.00 ~ tags[4],
  bathrooms > 4.00 & bathrooms <= 6.00 ~ tags[5],
))
summary(vgroup)
```


#Bins
```{r}
vgroup$tag <- factor(vgroup$tag, levels = tags, ordered = FALSE)
summary(vgroup$tag)
```


#Jitterplots with overlying boxplot
```{r}
ggplot(data = vgroup, mapping = aes(x=tag,y=price)) + 
  geom_jitter(aes(color='blue'),alpha=0.2) +
  geom_boxplot(fill="bisque",color="black",alpha=0.2) + 
  labs(x='Number of Bathrooms', y= 'Housing Price') +
  guides(color=FALSE) +
  theme_minimal() + scale_y_continuous(breaks = c(300000,600000,900000,2000000,4000000,5000000), labels = comma)
```

```{r}
ggplot(data = df, mapping = aes(x=factor(floors),y=price)) + 
  geom_jitter(aes(color='blue'),alpha=0.2) +
  geom_boxplot(fill="bisque",color="black",alpha=0.2) + 
  labs(x='Number of Floors', y= 'Housing Price') +
  guides(color=FALSE)  + scale_y_continuous(breaks = c(300000,600000,900000,2000000,4000000,5000000), labels = comma) + theme_minimal()


```

```{r}
ggplot(data = df, mapping = aes(x=factor(bedrooms),y=price)) + 
  geom_jitter(aes(color='blue'),alpha=0.2) +
  geom_boxplot(fill="bisque",color="black",alpha=0.2) + 
  labs(x='Number of Bedrooms', y= 'Housing Price') +
  guides(color=FALSE)  + scale_y_continuous(breaks = c(300000,600000,900000,2000000,4000000,5000000), labels = comma) + theme_minimal()

```

#Visualizing observations with a basement vs. no basement
```{r}
df$basement <- ifelse(df$sqft_basement == 0, 'No Basement','Basement')
ggplot(df, aes(x=basement, y=price, fill=basement)) +
  theme_solarized(light = TRUE) +
  scale_colour_solarized("red") +
  geom_violin(aes(color=basement)) +
  geom_boxplot(width=0.1) +
  ggtitle("Basement versus No Basement") +
  ylab("Price") +
  theme(legend.position="none", plot.title = element_text(hjust = 0.5))

```

```{r}
library(GGally)
quant.columns <- c(3,6,7,13,14)
ggpairs(df[quant.columns],title = "Correlogram of Quant. Columns")

```

```{r}
cor(bedrooms, sqft_living)
```

```{r}
lm_simp <- lm(price ~ sqft_living, data = df)
summary(lm_simp)
```

```{r}
lm_2 <- lm(price ~ sqft_living + basement, data = df)
summary(lm_2)
lm_6 <- lm(price ~ sqft_living + bedrooms + condition, data = df)
summary(lm_6)
```
```{r}
df$grade <- as.numeric(df$grade)
lm_top <- lm(price ~ sqft_living + waterfront + grade + bedrooms, data = df)
summary(lm_top)
anova(lm_top)
```



